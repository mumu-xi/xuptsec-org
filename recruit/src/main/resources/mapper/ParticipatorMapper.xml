<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//com.mapper.mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="org.xuptsec.recruit.dao.ParticipatorMapper">

    <insert id="insertParticipator" parameterType="participator">
        <selectKey resultType="java.lang.String" order="BEFORE" keyProperty="stuId">
            select uuid();
        </selectKey>
        insert into tb_participator (id,realname,gender,class,number,tel,classify,introduction)
        value(#{stuId},#{stuName},#{stuSex},#{stuClass},#{stuNumber},#{stuTel},#{stuGroup},#{stuIntro})
    </insert>
    <select id="findTotalParticipator" resultType="int">
        select count(*) from tb_participator where visibility=1
    </select>

    <resultMap id="participatorMap" type="participator">
        <id column="id" property="stuId"></id>
        <result column="realname" property="stuName"></result>
        <result column="gender" property="stuSex"></result>
        <result column="class" property="stuClass"></result>
        <result column="number" property="stuNumber"></result>
        <result column="tel" property="stuTel"></result>
        <result column="classify" property="stuGroup"></result>
        <result column="introduction" property="stuIntro"></result>
        <result column="time_table" property="schedule"></result>
    </resultMap>
    <select id="findParticipatorByPage" resultMap="participatorMap">
        select * from tb_participator  limit ${pageNum},${pageSize}
    </select>
    <select id="findParticipatorAll" resultMap="participatorMap">
         select * from tb_participator where visibility>=0  order by convert(time_table using gbk) ,convert(classify using gbk), convert(realname using gbk)
    </select>
    <select id="findParticipatorByStuNum" resultType="int">
        select count(*) from tb_participator where  number=#{stuNumber} and realname=#{stuName}
    </select>
    <select id="findNoticeParticipator" resultType="noticeParticipator">
        select id,realname stuName,gender stuSex,class stuClass,classify stuGroup,time_table schedule from tb_participator where visibility=1  order by convert(realname using gbk),convert(time_table using gbk) ,convert(classify using gbk)   limit ${pageNum},${pageSize}
    </select>
</mapper>